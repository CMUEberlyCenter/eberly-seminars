<section class="seminar-group <%= @seminar.status %> admin">
  <h1><%= @seminar.title %></h1>

  <%= render "participant_legend" %>

  <p class="date"><%= raw @seminar.formatted_timespan %></p>

  <p class="manage">
    <%= link_to "Edit", edit_admin_seminar_url(@seminar), :class => 'boxy' %>
    <% if @seminar.status == 'published' %>
      <%= link_to raw('<em>Unpublish</em>'), edit_admin_seminar_url(@seminar), :class => 'boxy' %>
    
    <% else %>
      <%= link_to 'Publish', edit_admin_seminar_url(@seminar), :class => 'boxy' %>
    <% end %>
  </p>
  
  <ul class="connected-sortable participants-list" id="registered-participants">
    <li class="cant-drag" id="add-participant"><%= link_to( image_tag( "face.png") + "+ Add Participant", new_admin_seminar_registration_path(@seminar), :remote => true ) %></li>
    <%= form_for [@seminar, @seminar.registrations.build], :url=> admin_seminar_path(@seminar), :html => {:class => "dropable", :id => 'registration_form'} do |f| %>
    
    <% @seminar.registrations.confirmed.each do |registration| %>
    <%#= f.fields_for :registrations, registration do |registration_form| %>
    <% css_classes = "participant"
       if registration.participant.student_class == "Masters"
         css_classes = css_classes + " masters"
       elsif registration.participant.student_class == "Doctoral"
         css_classes = css_classes + " phd"
       end
    %>
    <%# end %>

    <li id ="ids_<%=registration.id %>" class="<%= h css_classes %>" style="position: relative;">
      <%= link_to( image_tag("face.png") + registration.participant.name, '') %>

      <div class="attendance-form">
	<% AttendanceStatus.all.each do |status| %>
          <%= radio_button_tag( "attendance_status_#{registration.id.to_s}", status.id, registration.attendance_status_id == status.id ) %>
	  <%= label_tag "attendance_status_#{registration.id}_#{status.id}", status.status %>
        <% end %>
        <%= hidden_field_tag 'registration', registration.id %>
      </div>
    </li>
    <% end %>
  </ul>

  <ul class="connected-sortable participants-list" id="waitlisted_participants">

    <% @seminar.registrations.pending.each do |registration| %>
    <%= f.fields_for :registrations, registration do |registration_form| %>
    <% css_classes = "participant"
       if registration.participant.student_class == "Masters"
         css_classes = css_classes + " masters"
       elsif registration.participant.student_class == "Doctoral"
         css_classes = css_classes + " phd"
       end
    %>
    <li id= "ids_<%= registration.id %>" class="<%= h css_classes %>">     
      <%= link_to( image_tag("face.png") + registration.participant.name, '') %>
    </li>
    <% end %>
    <% end %>
  </ul>

  <%# f.submit "Update", :class => 'button' %>
  <% end %>
</section>

<!--
  <script>
    $('#registered-participants form li').sortElements(function(a, b){
    var stuff = new String($(a).text());
    return $(a).text().split(' ')[1] > $(b).text().split(' ')[1] ? 1 : -1;
    });
  </script>
-->
