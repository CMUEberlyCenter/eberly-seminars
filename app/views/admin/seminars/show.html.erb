<%= render "participant_legend" %>

  <section class="dialog" id="show-seminar">

  <h1>Teaching Seminars</h1>

  <h1 class="capacity">
    <%= image_tag "face.png" %> <%= @seminar.maximum_capacity %>
  </h1>

  <table>
    <tr>
      <td><%= @seminar.title %> <%= link_to "Edit", edit_admin_seminar_url(@seminar), :class => "button" %></td> 
      <td>
	<div class="capacity_meter"><span style="width: <%= h @seminar.capacity_percentage %>%"></span></div>
      </td>
    </tr>
    
    <tr>
      <td><%= @seminar.start_at.strftime("%a %B %e, %Y at %l:%M %P") %> - <%=@seminar.end_at.strftime("%l:%M %P") %></td>
    </tr>
  </table>

  <ul class="dialog connected-sortable submittable participants-list" id="registered_participants">
    <li class="cant-drag" id="add-participant"><%= link_to( image_tag( "face.png") + "+ Add Participant", new_admin_seminar_registration_path(@seminar), :remote => true ) %></li>
<%= form_for [@seminar, @seminar.registrations.build], :url=> admin_seminar_path(@seminar), :html => {:class => "dropable", :id => 'registration_form'} do |f| %>

    <% @seminar.registrations.confirmed.each do |registration| %>
    <%= f.fields_for :registrations, registration do |registration_form| %>
    <% css_classes = "participant"
       if registration.participant.student_class == "Masters"
         css_classes = css_classes + " masters"
       elsif registration.participant.student_class == "Doctoral"
         css_classes = css_classes + " phd"
       end
    %>
    <li id ="ids_<%=registration.id %>" class="<%= h css_classes %>">
      <%= link_to( image_tag("face.png") + registration.participant.name, '') %>
    </li>
    <% end %>
    <% end %>
  </ul>
  <script>
    $('#registered_participants form li').sortElements(function(a, b){
    var stuff = new String($(a).text());
    /*alert( stuff );*/
    return $(a).text().split(' ')[1] > $(b).text().split(' ')[1] ? 1 : -1;
});
</script>
</section>

<section class="dialog" id="waitlist">
  <h1><%= image_tag "face.png" %> Waitlisted <%= @seminar.registrations.pending.size %></h1>


    <ul class="dialog connected-sortable participants-list" id="waitlisted_participants">

      <% @seminar.registrations.pending.each do |registration| %>
      <%= f.fields_for :registrations, registration do |registration_form| %>
    <% css_classes = "participant"
       if registration.participant.student_class == "Masters"
         css_classes = css_classes + " masters"
       elsif registration.participant.student_class == "Doctoral"
         css_classes = css_classes + " phd"
       end
    %>
      <li id= "ids_<%= registration.id %>" class="<%= h css_classes %>">     
	<%= link_to( image_tag("face.png") + registration.participant.name, '') %>
      </li>
      <% end %>
      <% end %>
    </ul>

  
</section>
<%# f.submit "Update", :class => 'button' %>
<% end %>
