
  
<script>
$(function() {


var drpOptions = {
  drop: function(event, ui) {
    //$(this).append( ui.draggable.text() + "<br>" );
    $(this).append( ui.draggable.html() );

  }
};

//$( "#registered_participants ul" ).droppable( drpOptions );

//$( "#registered_participants > ul", "#waitlisted_participants > ul" ).sortable({ connectWith: ".connected-sortable", revert: true, placeholder: "ui-draggable-dragging" }).disableSelection();

$( "#registered_participants, #waitlisted_participants" ).sortable({ connectWith: ".connected-sortable", items: "li:not(.cant-drag)", placeholder: "ui-draggable-dragging" }).disableSelection();


//$( "#waitlisted_participants ul" ).sortable({ revert: true, placeholder: "ui-draggable-dragging" });


/*$( "button" ).button().click(function() {
  $( "<li>Dynamic droppable<hr></li>" ).droppable( drpOptions ).appendTo( "#drplist" );
});*/




//$( ".participant" ).draggable({ revert: "invalid" });
/*
$( "#show" ).droppable({
activeClass: "ui-state-hover",
hoverClass: "ui-state-active",
drop: function( event, ui ) {
$( this )
.addClass( "moved" )
.find( "p" )
.html( "Dropped!" );
}
});
*/

/*$( "#waitlist" ).droppable({
activeClass: "ui-state-hover",
hoverClass: "moved",
drop: function( event, ui ) {
$( this )
.addClass( "moved" );
}
});
*/
});

</script>



<%= render "participant_legend" %>


<%= form_for [@seminar, @seminar.registrations.build], :url => admin_seminar_path(@seminar), :html => {:class => "dropable"} do |f| %>

<section class="dialog" id="show-seminar">

  <h1>Teaching Seminars</h1>

  <h1 class="capacity">
    <%= image_tag "face.png" %> <%= @seminar.maximum_capacity %>
  </h1>

  <table>
    <tr>
      <td><%= @seminar.title %></td>
      <td>
	<div class="capacity_meter"><span style="width: <%= h @seminar.capacity_percentage %>%"></span></div>
      </td>
    </tr>
    
    <tr>
      <td><%= @seminar.start_at.strftime("%a %B %e, %Y at %l:%M %P") %> - <%=@seminar.end_at.strftime("%l:%M %P") %></td>
    </tr>
  </table>

    <ul class="dialog connected-sortable participants-list" id="registered_participants">
      <li class="cant-drag add-participant"><%= link_to( image_tag( "face.png") + "+ Add Participant", new_admin_seminar_registration_path(@seminar) ) %></li>
      <li class="participant"><%= image_tag "face.png" %> Meg Richards</li>
      <li class="participant"><%= image_tag "face.png" %> Meggie Hayes</li>
      <li class="participant"><%= image_tag "face.png" %> Ruth Poproski</li>
    </ul>
 


<% @seminar.registrations.confirmed.each do |p| %>
<div class="participant_listing">
  <%= p.participant.andrewid %>
</div>
<% end %>


</section>


<section class="dialog" id="waitlist">
  <h1><%= image_tag "face.png" %> Waitlisted <%= @seminar.registrations.pending.size %></h1>


    <ul class="dialog connected-sortable participants-list" id="waitlisted_participants">
      <% @seminar.registrations.pending.each do |registration| %>
      <%= f.fields_for :registrations, registration do |registration_form| %>
      <li class="participant">     
	<%= image_tag "face.png" %>
	<%= registration.participant.name %>
	<%= registration_form.hidden_field :id, :class => "id" %>
      </li>
      <% end %>
      <% end %>
    </ul>

  
</section>
<%#= f.submit "Update", :class => "button" %>
<% end %>

<script>
/*
  $(function() {
  $( "#waitlisted_participants" ).sortable();
  $( "#waitlisted_participants" ).disableSelection();
  });

jQuery(function($) {

    /* Make the form sortable *
    $("form ul").sortable();

    /* On submit, set the value of the position inputs to the value of their current physical position in the list *
    $('form.sortable').submit(function() {

        $("form ul li input.position").each(function(index) {
            $(this).val(index);
         });

        return true;
    });

});
*/
</script>
